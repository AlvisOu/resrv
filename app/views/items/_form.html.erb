<%= form_with model: [@workspace, @item], local: true do |f| %>
  <div>
    <%= f.label :name, "Item Name" %><br>
    <%= f.text_field :name, required: true %>
  </div>

  <div>
    <%= f.label :quantity, "Quantity" %><br>
    <%= f.number_field :quantity, min: 0, required: true %>
  </div>

  <div>
    <%= f.label :start_time, "Available From" %><br>
    <%= f.time_select :start_time, minute_step: 15 %>
  </div>

  <div>
    <%= f.label :end_time, "Available Until" %><br>
    <%= f.time_select :end_time, minute_step: 15 %>
  </div>

  <br>
  <%= f.submit "Confirm", class: "btn-primary" %>
  
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.querySelector("form[action*='items']");
      if (!form) return;

      const inputs = form.querySelectorAll("input, select, textarea");

      inputs.forEach((input) => {
        input.addEventListener("change", () => {
          input.dataset.changed = "true";
          input.style.backgroundColor = "#fff8e1";  // soft yellow
          input.style.borderColor = "#facc15";      // amber
        });
      });

      form.addEventListener("submit", () => {
        inputs.forEach((input) => {
          if (input.dataset.changed === "true") {
            input.style.backgroundColor = "";
            input.style.borderColor = "";
            delete input.dataset.changed;
          }
        });
      });
    });
  </script>

<% end %>

<% if @item.persisted? %>
  <%= form_with model: [@workspace, @item], method: :delete, local: true do |f| %>
    <%= f.submit "Delete", data: { confirm: "Are you sure you want to delete this item?" }, class: "btn-danger" %>
  <% end %>
<% end %>